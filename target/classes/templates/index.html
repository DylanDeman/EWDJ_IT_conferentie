<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" 
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head th:replace="layout/base :: head">
    <title th:text="#{app.name}">IT Conference</title>
</head>
<body>
    <div th:replace="layout/base :: nav"></div>

    <!-- Hero Section -->
    <div class="bg-primary text-white py-5">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-md-6">
                    <h1 class="display-4" th:text="#{home.hero.title}">Welcome to IT Conference 2025</h1>
                    <p class="lead" th:text="#{home.hero.subtitle}">
                        Join us for three days of cutting-edge technology, networking, and learning.
                    </p>
                    <div class="mt-4">
                        <!-- Show Browse Events only to anonymous users -->
                        <a th:href="@{/events}" class="btn btn-light btn-lg me-3" 
                           sec:authorize="!isAuthenticated()" 
                           th:text="#{home.hero.browse}">
                            Browse Events
                        </a>

                        <!-- Show Add Event button only to ADMIN -->
                        <a th:href="@{/events/new}" class="btn btn-warning btn-lg me-3" 
                           sec:authorize="hasRole('ADMIN')" 
                           th:text="#{home.hero.addEvent}">
                            Add Event
                        </a>

                        <!-- Show View Rooms always -->
                        <a th:href="@{/rooms}" class="btn btn-outline-light btn-lg" th:text="#{home.hero.rooms}">
                            View Rooms
                        </a>
                    </div>
                </div>
                <div class="col-md-6 text-center">
                    <img th:src="@{/images/conference.jpg}" alt="Conference" class="img-fluid rounded shadow">
                </div>
            </div>
        </div>
    </div>

    <!-- Featured Events -->
    <div class="container mt-5">
        <h2 class="text-center mb-4" th:text="#{home.featured.title}">Featured Events</h2>
        <div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4">
            <div th:each="event : ${featuredEvents}" class="col">
                <div class="card h-100">
                    <div class="card-body">
                        <h5 class="card-title" th:text="${event.name}">Event Name</h5>
                        <p class="card-text" th:text="${#strings.abbreviate(event.description, 100)}">Description</p>
                        <dl class="row mb-0">
                            <dt class="col-sm-4" th:text="#{event.datetime}">Date & Time</dt>
                            <dd class="col-sm-8" th:text="${#temporals.format(event.dateTime, #messages.msg('app.date.format'))}">
                                Date Time
                            </dd>
                            <dt class="col-sm-4" th:text="#{event.room}">Room</dt>
                            <dd class="col-sm-8" th:text="${event.room.name}">Room</dd>
                            <dt class="col-sm-4" th:text="#{event.price}">Price</dt>
                            <dd class="col-sm-8" th:text="${#numbers.formatCurrency(event.price)}">Price</dd>
                        </dl>
                    </div>
                    <div class="card-footer">
                        <div class="d-flex justify-content-between align-items-center">
                            <a th:href="@{/events/{id}(id=${event.id})}" class="btn btn-primary" 
                               th:text="#{event.details.button}">View Details</a>
                            <div sec:authorize="hasRole('USER')">
                                <form th:if="${!event.favorite}" 
                                      th:action="@{/user/favorites/add/{id}(id=${event.id})}" 
                                      method="post" style="display: inline;">
                                    <button type="submit" class="btn btn-outline-primary" 
                                            th:text="#{favorite.add.button}">
                                        <i class="fas fa-star"></i>
                                    </button>
                                </form>
                                <form th:if="${event.favorite}" 
                                      th:action="@{/user/favorites/remove/{id}(id=${event.id})}" 
                                      method="post" style="display: inline;">
                                    <button type="submit" class="btn btn-primary" 
                                            th:text="#{favorite.remove.button}">
                                        <i class="fas fa-star"></i>
                                    </button>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="text-center mt-4">
            <a th:href="@{/events}" class="btn btn-primary" th:text="#{home.featured.viewAll}">
                View All Events
            </a>
        </div>
    </div>

    <!-- Quick Links -->
    <div class="container mt-5 mb-5">
        <div class="row g-4">
            <div class="col-md-4">
                <div class="card h-100">
                    <div class="card-body text-center">
                        <i class="fas fa-calendar-alt fa-3x text-primary mb-3"></i>
                        <h3 class="card-title" th:text="#{home.links.schedule.title}">Event Schedule</h3>
                        <p class="card-text" th:text="#{home.links.schedule.description}">
                            Browse our comprehensive schedule of events and plan your conference experience.
                        </p>
                        <a th:href="@{/events}" class="btn btn-outline-primary" th:text="#{home.links.schedule.button}">
                            View Schedule
                        </a>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="card h-100">
                    <div class="card-body text-center">
                        <i class="fas fa-map-marker-alt fa-3x text-primary mb-3"></i>
                        <h3 class="card-title" th:text="#{home.links.rooms.title}">Conference Rooms</h3>
                        <p class="card-text" th:text="#{home.links.rooms.description}">
                            Explore our state-of-the-art conference rooms and their facilities.
                        </p>
                        <a th:href="@{/rooms}" class="btn btn-outline-primary" th:text="#{home.links.rooms.button}">
                            View Rooms
                        </a>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="card h-100">
                    <div class="card-body text-center">
                        <i class="fas fa-star fa-3x text-primary mb-3"></i>
                        <h3 class="card-title" th:text="#{home.links.favorites.title}">My Favorites</h3>
                        <p class="card-text" th:text="#{home.links.favorites.description}">
                            Keep track of your favorite events and never miss a session.
                        </p>
                        <!-- Favorites button only for logged in USER -->
                        <a th:href="@{/user/favorites}" class="btn btn-outline-primary" 
                           th:text="#{home.links.favorites.button}"
                           sec:authorize="hasRole('USER')">
                            View Favorites
                        </a>
                        <!-- Login button if not authenticated -->
                        <a th:href="@{/login}" class="btn btn-outline-primary" 
                           th:text="#{home.links.favorites.login}"
                           sec:authorize="!isAuthenticated()">
                            Login to Save Favorites
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>
</html>
