<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" 
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head th:replace="layout/base :: head">
    <title th:text="#{room.list.title} + ' - ' + #{app.name}">Rooms</title>
</head>
<body>
    <div th:replace="layout/base :: nav"></div>

    <div class="container mt-4">
        <div class="row mb-4">
            <div class="col">
                <h1 th:text="#{room.list.title}">Rooms</h1>
            </div>
            <div class="col-auto" sec:authorize="hasRole('ADMIN')">
                <a th:href="@{/rooms/new}" class="btn btn-primary" th:text="#{room.create.button}">
                    Create New Room
                </a>
            </div>
        </div>

        <!-- Filters -->
        <div class="card mb-4">
            <div class="card-body">
                <form th:action="@{/rooms}" method="get" class="row g-3">
                    <div class="col-md-4">
                        <label for="capacity" class="form-label" th:text="#{room.filter.capacity}">Minimum Capacity</label>
                        <input type="number" class="form-control" id="capacity" name="capacity" 
                               th:value="${param.capacity}" min="1">
                    </div>
                    <div class="col-md-4">
                        <label for="sort" class="form-label" th:text="#{room.filter.sort}">Sort By</label>
                        <select class="form-select" id="sort" name="sort">
                            <option value="name" th:selected="${param.sort == null or param.sort[0] == 'name'}"
                                    th:text="#{room.sort.name}">Name</option>
                            <option value="capacity" th:selected="${param.sort != null and param.sort[0] == 'capacity'}"
                                    th:text="#{room.sort.capacity}">Capacity</option>
                        </select>
                    </div>
                    <div class="col-12">
                        <button type="submit" class="btn btn-primary" th:text="#{room.filter.apply}">Apply Filters</button>
                        <a th:href="@{/rooms}" class="btn btn-secondary" th:text="#{room.filter.clear}">Clear Filters</a>
                    </div>
                </form>
            </div>
        </div>

        <!-- Rooms List -->
        <div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4">
            <div th:each="room : ${rooms}" class="col">
                <div class="card h-100">
                    <div class="card-body">
                        <h5 class="card-title" th:text="${room.name}">Room Name</h5>
                        <dl class="row mb-0">
                            <dt class="col-sm-4" th:text="#{room.capacity}">Capacity</dt>
                            <dd class="col-sm-8">
                                <span th:text="${room.capacity}">Capacity</span>
                                <span th:text="#{room.capacity.seats}">seats</span>
                            </dd>
                            <dt class="col-sm-4" th:text="#{room.events}">Events</dt>
                            <dd class="col-sm-8" th:text="${room.events.size()}">0</dd>
                        </dl>
                    </div>
                    <div class="card-footer">
                        <div class="d-flex justify-content-between align-items-center">
                            <a th:href="@{/rooms/{id}(id=${room.id})}" class="btn btn-primary" 
                               th:text="#{room.details.button}">View Details</a>
                            <div sec:authorize="hasRole('ADMIN')">
                                <a th:href="@{/rooms/{id}/edit(id=${room.id})}" class="btn btn-warning" 
                                   th:text="#{room.edit.button}">Edit</a>
                                <form th:action="@{/rooms/{id}/delete(id=${room.id})}" method="post" 
                                      style="display: inline;">
                                    <button type="submit" class="btn btn-danger" 
                                            th:text="#{room.delete.button}"
                                            onclick="return confirm('#{room.delete.confirm}')">
                                        Delete
                                    </button>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Empty State -->
        <div th:if="${#lists.isEmpty(rooms)}" class="text-center mt-4">
            <p class="lead" th:text="#{room.list.empty}">No rooms found matching your criteria.</p>
        </div>
    </div>
</body>
</html> 